(this.webpackJsonpminesweeper_react=this.webpackJsonpminesweeper_react||[]).push([[0],{46:function(e,t,n){e.exports=n(59)},51:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(37),l=n.n(o),c=(n(51),n(10)),i=n(4),s=n(1),u=n.n(s),m=n(2),d=n(7),f=n(30),b=n.n(f),p=function(e){var t=e.board;return r.a.createElement("tr",null,r.a.createElement("td",null,t.rows),r.a.createElement("td",null,t.columns),r.a.createElement("td",null,t.mines),r.a.createElement("td",null,t.finished&&r.a.createElement("i",{className:"fa fa-check"})),r.a.createElement("td",null,b()(t.created).format("MM/DD/YYYY HH:mm:ss")),r.a.createElement("td",null,b()(t.modified).format("MM/DD/YYYY HH:mm:ss")),r.a.createElement("td",null,r.a.createElement(c.b,{to:"/".concat(t.id),className:"btn btn-info"},"View board")))},E=function(e){var t=e.boards;return t=t||[],r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Rows"),r.a.createElement("th",null,"Columns"),r.a.createElement("th",null,"Mines"),r.a.createElement("th",null,"Finshed"),r.a.createElement("th",null,"Created"),r.a.createElement("th",null,"Last modified"),r.a.createElement("th",null))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement(p,{key:e.id,board:e})}))))},v=n(19),h=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],o=t[1],l=Object(v.b)("/api/v1/boards/",{cachePolicy:"no-cache"}),i=l.get,s=l.response,f=l.loading,b=l.error;return Object(a.useEffect)((function(){function e(){return(e=Object(m.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i("");case 2:t=e.sent,s.ok&&o(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h3",null,"Created boards "," ",r.a.createElement(c.b,{to:"/new",className:"btn btn-primary"},"New board")),b&&"Error loading boards!",f&&"Loading boards...",r.a.createElement(E,{boards:n}))},w=n(16),g=n(26),k=n(27);function N(){var e=Object(g.a)(["\n    background-color: "," \n    border: 1px solid #eeeeee;\n    width: 32px;\n    height: 32px;\n    font-size: 24px;\n    padding: 2px;\n    vertical-align: middle;\n    text-align: center;\n    line-height: 1;\n    cursor: pointer;\n\n    &:hover {\n        cursor: pointer;\n    }\n\n"]);return N=function(){return e},e}function x(){var e=Object(g.a)(["\n    background-color: #eeeeee;\n    "]);return x=function(){return e},e}function y(){var e=Object(g.a)(["\n    background-color: #eeeeee;\n"]);return y=function(){return e},e}var C=k.a.table(y()),O=k.a.tr(x()),j=k.a.td(N(),(function(e){return isNaN(parseInt(e.value))?"#aaaaaa;":"#cccccc;"})),M=function(e){var t=e.boardCell,n=e.rowPos,a=e.colPos,o=e.onReveal,l=e.onMark;return r.a.createElement(j,{onClick:function(e){e.preventDefault(),e.ctrlKey?l(n,a):o(n,a)},value:t},"!"===t&&r.a.createElement("i",{className:"fa fa-flag"}),"?"===t&&r.a.createElement("i",{className:"fa fa-question"}),"*"===t&&r.a.createElement("i",{className:"fa fa-bomb"}),"**"===t&&r.a.createElement("i",{className:"fa fa-bomb text-danger"})," "===t&&" ",parseInt(t)>0&&t)},R=function(e){var t=e.boardRow,n=e.rowPos,a=e.onReveal,o=e.onMark;return r.a.createElement(O,null,t.map((function(e,t){return r.a.createElement(M,{key:t,rowPos:n,colPos:t,boardCell:e,onReveal:a,onMark:o})})))},Y=function(e){var t=e.board,n=e.onReveal,a=e.onMark;return r.a.createElement(C,null,r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement(R,{key:t,rowPos:t,boardRow:e,onReveal:n,onMark:a})}))))},H=function(e){if(e.finished){var t,n=Object(w.a)(e.display_board);try{for(n.s();!(t=n.n()).done;){var a,r=t.value,o=Object(w.a)(r);try{for(o.s();!(a=o.n()).done;){if("**"===a.value)return!1}}catch(l){o.e(l)}finally{o.f()}}}catch(l){n.e(l)}finally{n.f()}return!0}return!1},P=function(){var e=Object(i.g)().boardId,t=Object(i.f)(),n="/api/v1/boards/".concat(e,"/"),o=Object(a.useState)(null),l=Object(d.a)(o,2),s=l[0],f=l[1],b=Object(v.b)("",{cachePolicy:"no-cache"}),p=b.get,E=b.put,h=b.del,w=b.response,g=b.loading,k=b.error,N=b.cache;Object(a.useEffect)((function(){function e(){return(e=Object(m.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(n);case 2:t=e.sent,w.ok&&f(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[e]);var x=function(){var e=Object(m.a)(u.a.mark((function e(t,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s||!s.finished){e.next=2;break}return e.abrupt("return");case 2:if(!g){e.next=5;break}return console.log("Cannot reveal the cell: pending operation."),e.abrupt("return");case 5:return e.next=7,E(n,{row:t,column:a,operation:"reveal_cell"});case 7:if(r=e.sent,!w.ok){e.next=12;break}return f(r),e.next=12,N.delete();case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(m.a)(u.a.mark((function e(t,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s||!s.finished){e.next=2;break}return e.abrupt("return");case 2:if(!g){e.next=5;break}return console.log("Cannot mark the cell: pending operation."),e.abrupt("return");case 5:return e.next=7,E(n,{row:t,column:a,operation:"mark_cell"});case 7:if(r=e.sent,!w.ok){e.next=12;break}return f(r),e.next=12,N.delete();case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C=function(){var e=Object(m.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=3;break}return console.log("Cannot delete the board: pending operation."),e.abrupt("return");case 3:if(!window.confirm("Do you want to delete this board?")){e.next=7;break}return e.next=6,h(n);case 6:w.ok&&t.replace("/");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h3",null,"Minesweeper Board"),s&&!s.finished&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("span",{className:"badge badge-info"},"Click")," to reveal a cell"),r.a.createElement("div",null,r.a.createElement("span",{className:"badge badge-info"},"Ctrl + Click")," to mark a cell")),s&&s.finished&&H(s)&&r.a.createElement("div",null,r.a.createElement("span",{className:"badge badge-info text-uppercase"},"You won!!!")),s&&s.finished&&!H(s)&&r.a.createElement("div",null,r.a.createElement("span",{className:"badge badge-danger text-uppercase"},"You lost")),r.a.createElement("div",null,r.a.createElement("span",{style:{visibility:"hidden"}},"Status: "),k&&"Error loading boards!",g&&"Loading boards..."),s&&r.a.createElement(Y,{board:s.display_board,onReveal:x,onMark:y}),r.a.createElement("div",{className:"mt-3"},r.a.createElement(c.b,{to:"/",className:"btn btn-primary"},"Return")," ",r.a.createElement("button",{className:"btn btn-danger",onClick:C},"Delete this board")))},D=n(14),S=n(45),F=n(24),_=F.b().shape({rows:F.a().transform((function(e){return isNaN(e)?void 0:e})).required("You must write the number or rows").integer().min(10).max(30),columns:F.a().transform((function(e){return isNaN(e)?void 0:e})).required("You must write the number of columns").integer().min(10).max(30),mines:F.a().transform((function(e){return isNaN(e)?void 0:e})).required("You must write the number of mines").integer().min(14).test("minesOverflow","The number of mines cannot be greater than the amount of cells",(function(e){return e<=this.parent.rows*this.parent.columns}))}),q=function(){var e,t,n,a=Object(v.b)("/api/v1/boards/",{cachePolicy:"no-cache"}),o=a.post,l=a.response,s=a.loading,d=a.error,f=Object(i.f)(),b=Object(D.c)({resolver:Object(S.a)(_)}),p=b.register,E=b.handleSubmit,h=b.errors,w=function(){var e=Object(m.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("",t);case 2:n=e.sent,l.ok?f.push("/".concat(n.id)):d&&alert("Error creating a board.");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h3",null,"New board"),d&&"Error loading boards!",s&&"Creating board...",r.a.createElement("form",{onSubmit:E((function(e){void 0===e||s||w(e)}))},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"inputRowCount",className:"font-weight-bold"},"Row count:"),r.a.createElement("input",{type:"number",name:"rows",className:"form-control ".concat(h.rows&&"is-invalid"),id:"inputRowCount","aria-describedby":"rowCountHelp",defaultValue:10,ref:p({required:!0})}),!h.rows&&r.a.createElement("small",{id:"rowCountHelp",className:"form-text text-muted"},"Count of rows (between 10 and 30)."),h.rows&&r.a.createElement("div",{className:"invalid-feedback"},null===(e=h.rows)||void 0===e?void 0:e.message)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"inputColumnCount",className:"font-weight-bold"},"Column count:"),r.a.createElement("input",{type:"number",name:"columns",className:"form-control ".concat(h.columns&&"is-invalid"),id:"inputColumnCount","aria-describedby":"columnCountHelp",defaultValue:10,ref:p}),!h.columns&&r.a.createElement("small",{id:"columnCountHelp",className:"form-text text-muted"},"Count of columns (between 10 and 30)."),h.columns&&r.a.createElement("div",{className:"invalid-feedback"},null===(t=h.columns)||void 0===t?void 0:t.message)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"inputMinesCount",className:"font-weight-bold"},"Mines count:"),r.a.createElement("input",{type:"number",name:"mines",className:"form-control ".concat(h.mines&&"is-invalid"),id:"inputMinesCount","aria-describedby":"minesCountHelp",defaultValue:14,ref:p}),!h.mines&&r.a.createElement("small",{id:"minesCountHelp",className:"form-text text-muted"},"Count of mines."),h.mines&&r.a.createElement("div",{className:"invalid-feedback"},null===(n=h.mines)||void 0===n?void 0:n.message)),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Create")," ",r.a.createElement(c.b,{to:"/",className:"btn btn-secondary"},"Cancel")))};var I=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",null,"MineSweeper ",r.a.createElement("a",{href:"/accounts/logout",className:"btn btn-link"},"Logout"))),r.a.createElement(c.a,null,r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/new"},r.a.createElement(q,null)),r.a.createElement(i.a,{path:"/:boardId"},r.a.createElement(P,null)),r.a.createElement(i.a,{path:"/"},r.a.createElement(h,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[46,1,2]]]);
//# sourceMappingURL=main.1ec4442f.chunk.js.map